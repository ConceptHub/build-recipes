NAME='tinker'
MAJOR_VERSION=8
MINOR_VERSION=10.2
PACKAGE_NAME=$NAME

BUILD_DIR=~/build

VERSION=${MAJOR_VERSION}.${MINOR_VERSION}
FILE_NAME=$NAME-${VERSION}'.tar.gz'


# ===

COMPILER='intel'

cd $BUILD_DIR
rm -fr $PACKAGE_NAME
tar xvf $FILE_NAME

module purge
module load intel
module load mkl/latest
module load compiler/latest

INSTALL_PREFIX=/opt/software/$NAME/$MAJOR_VERSION/${VERSION}-${COMPILER}

export LANG=C
export LC_ALL=C

cd ~/build/$PACKAGE_NAME/source

patch -p0 < ../../tinker-8.10.2.Makefile.intel.mkl.patch

make -j 24 all

HOME=~/build/ make install

mkdir -p ${INSTALL_PREFIX}

cp -pr ../bin ${INSTALL_PREFIX}/

rm -f ${INSTALL_PREFIX}/0README

cd ~/build
rm -fr ~/build/$PACKAGE_NAME

